!function(e,o){function t(e){this.id=o.observable(e.id),this.name=o.observable(e.name),this.contact=o.observable(e.contact),this.location=o.observable(e.location),this.categories=o.observable(e.categories);var t=e.categories[0]?e.categories[0].name:"";this.category=o.observable(t)}function a(){function a(e){l={lat:e.coords.latitude,lng:e.coords.longitude};var o=s+"&ll="+l.lat+","+l.lng;n(o,i)}function i(o){if(!o)return void u.status("Unable to connect to Foursquare...");if(!o.response||!o.response.venues||0===o.response.venues.length)return void u.status("Sorry, Foursquare has no your neighborhood data...");var a=o.response.venues,n=$.map(a,function(e){return mapControl.isGoogleMapLoad()&&mapControl.addMaker(e.id,e.location,e),new t(e)});mapControl.isGoogleMapLoad()&&mapControl.map.fitBounds(mapControl.bounds),mapControl.setCenter(l.lat,l.lng),u.places(n),u.status("Not Found..."),e.saveToLocalStorage("neighborhood-map",o)}function c(e){e.PERMISSION_DENIED||alert("Get current position failï¼"),r(a)}var u=this;u.status=o.observable("Loading..."),u.places=o.observableArray([]),u.activePlace=o.observable(""),u.showPlace=function(e){u.activePlace(e.id()),mapControl.focusToMarkerById(e.id())},u.filterInput=o.observable(""),u.categoryInput=o.observable(""),u.filter=function(){},u.filteredPlaces=o.computed(function(){var e=u.filterInput().toLowerCase().trim(),o=u.categoryInput().toLowerCase().trim();if(e||o){var t=u.places().filter(function(t){return e&&t.name().toLowerCase().indexOf(e)>=0||o&&t.category().toLowerCase().indexOf(o)>=0});return t=t?t:[],mapControl.filterMarkers(t),t}return mapControl.filterMarkers(u.places()),u.places()}),e.getLocalStorage("neighborhood-map",i),navigator.geolocation?navigator.geolocation.getCurrentPosition(a,c):r(a)}function n(e,o){$.getJSON(e,function(e){e||(e=[]),o(e)}).fail(function(){o(null)})}function r(e){e({coords:{latitude:40.7053111,longitude:-74.258188}})}function i(){var e=u,o="0px"===e.css("left")?"240px":0;e.animate({left:o},220),c.sidebar("toggle")}var s="https://api.foursquare.com/v2/venues/search?oauth_token=EACTJOEC3DFI4G4FHBQILJ1WVA1ZASBOIE4E5SKCO04ACVBC&v=20160323",l={};e.vm=new a,o.applyBindings(vm);var c=$(".ui.sidebar").sidebar("setting","transition","overlay").sidebar("setting","dimPage",!1).sidebar("setting","closable",!1),u=$("#toggle-list").on("click",i);e.fetchData=n,$("body").removeClass("pushable")}(window,ko);